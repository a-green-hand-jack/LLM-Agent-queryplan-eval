<!-- 307ff54d-e6ed-49f4-a239-413cda698004 eabcc795-0730-4337-87e6-8c780466d6a0 -->
# 为 Dataset 添加数据分割功能

## 第一步：创建 utils.py 文件

在 `src/queryplan_eval/datasets/utils.py` 中定义：

### SplitConfig 数据类
- `split_type: str` - 分割类型，支持 "train_eval"、"train_test"、"eval_test"、"train_eval_test"
- `train_ratio: Optional[float]` - 训练集比例（仅用于两分割时）
- `eval_ratio: Optional[float]` - 评估集比例（三分割时使用）
- `test_ratio: Optional[float]` - 测试集比例（仅用于包含 test 的分割）
- `random_seed: int` - 随机数种子（默认 42）
- 验证方法：确保比例总和为 1.0

### split_dataset 函数
签名：`split_dataset(dataset: QueryPlanDataset, config: SplitConfig) -> Dict[str, QueryPlanDataset]`

功能：
- 根据配置的 `split_type` 确定如何分割
- 使用 HuggingFace Dataset 的 `train_test_split` 方法进行递归分割
- 返回字典，键为分割集名称（如 "train"、"eval"、"test"）
- 每个值是新的 QueryPlanDataset 实例

## 第二步：更新 __init__.py

在 `src/queryplan_eval/datasets/__init__.py` 中：
- 添加导入：`from .utils import split_dataset, SplitConfig`
- 更新 `__all__` 列表

## 第三步：使用示例文档

添加详细的使用示例说明：
- 两分割示例（train_eval、train_test、eval_test）
- 三分割示例（train_eval_test）
- 如何创建自定义配置对象

## 关键实现细节

### 分割逻辑
1. **train_eval**: 分割为 [train, eval]
   - 比例：train_ratio : (1 - train_ratio)

2. **train_test**: 分割为 [train, test]
   - 比例：train_ratio : (1 - train_ratio)

3. **eval_test**: 分割为 [eval, test]
   - 比例：eval_ratio : (1 - eval_ratio)

4. **train_eval_test**: 分割为 [train, eval, test]
   - 第一步：train vs (eval+test)，比例为 train_ratio : (1 - train_ratio)
   - 第二步：对 (eval+test) 进一步分割，比例为 eval_ratio/(eval_ratio+test_ratio) : test_ratio/(eval_ratio+test_ratio)

### 返回的 QueryPlanDataset 处理
- 创建新的 QueryPlanDataset 实例
- 从分割后的 HuggingFace Dataset 初始化
- 重新调整 idx（从 0 开始）以保持一致性

### 类型注解
- 使用 Literal 类型标注 split_type 的有效值
- 对所有参数和返回值提供完整类型注解

### To-dos

- [ ] 创建 SplitConfig 数据类，包含 split_type、train_ratio、eval_ratio、test_ratio、random_seed 字段
- [ ] 实现 split_dataset 函数，支持四种分割类型的递归分割逻辑
- [ ] 更新 src/queryplan_eval/datasets/__init__.py，导出 SplitConfig 和 split_dataset
- [ ] 在 QueryPlanDataset 中添加从 HuggingFace Dataset 初始化的方法或工厂函数
- [ ] 为数据分割功能编写单元测试，验证各种分割类型的正确性